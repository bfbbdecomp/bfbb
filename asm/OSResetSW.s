.include "macros.inc"
.file "OSResetSW.c"

# 0x801D565C - 0x801D59E8
.text
.balign 4

.fn __OSResetSWInterruptHandler, global
/* 801D565C 001D273C  7C 08 02 A6 */	mflr r0
/* 801D5660 001D2740  90 01 00 04 */	stw r0, 0x4(r1)
/* 801D5664 001D2744  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 801D5668 001D2748  93 E1 00 24 */	stw r31, 0x24(r1)
/* 801D566C 001D274C  93 C1 00 20 */	stw r30, 0x20(r1)
/* 801D5670 001D2750  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 801D5674 001D2754  48 00 1E F9 */	bl __OSGetSystemTime
/* 801D5678 001D2758  3C A0 80 00 */	lis r5, 0x8000
/* 801D567C 001D275C  90 8D 9C C4 */	stw r4, HoldDown+0x4@sda21(r13)
/* 801D5680 001D2760  80 05 00 F8 */	lwz r0, 0xf8(r5)
/* 801D5684 001D2764  3C 80 43 1C */	lis r4, 0x431c
/* 801D5688 001D2768  38 84 DE 83 */	addi r4, r4, -0x217d
/* 801D568C 001D276C  90 6D 9C C0 */	stw r3, HoldDown@sda21(r13)
/* 801D5690 001D2770  54 00 F0 BE */	srwi r0, r0, 2
/* 801D5694 001D2774  7C 04 00 16 */	mulhwu r0, r4, r0
/* 801D5698 001D2778  54 00 8B FE */	srwi r0, r0, 15
/* 801D569C 001D277C  1C 00 00 64 */	mulli r0, r0, 0x64
/* 801D56A0 001D2780  54 1D E8 FE */	srwi r29, r0, 3
/* 801D56A4 001D2784  3B C0 00 00 */	li r30, 0x0
/* 801D56A8 001D2788  3F E0 CC 00 */	lis r31, 0xcc00
.L_801D56AC:
/* 801D56AC 001D278C  48 00 1E C1 */	bl __OSGetSystemTime
/* 801D56B0 001D2790  80 CD 9C C4 */	lwz r6, HoldDown+0x4@sda21(r13)
/* 801D56B4 001D2794  6F C5 80 00 */	xoris r5, r30, 0x8000
/* 801D56B8 001D2798  80 0D 9C C0 */	lwz r0, HoldDown@sda21(r13)
/* 801D56BC 001D279C  7C 86 20 10 */	subfc r4, r6, r4
/* 801D56C0 001D27A0  7C 00 19 10 */	subfe r0, r0, r3
/* 801D56C4 001D27A4  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 801D56C8 001D27A8  7C 1D 20 10 */	subfc r0, r29, r4
/* 801D56CC 001D27AC  7C A5 19 10 */	subfe r5, r5, r3
/* 801D56D0 001D27B0  7C A3 19 10 */	subfe r5, r3, r3
/* 801D56D4 001D27B4  7C A5 00 D1 */	neg. r5, r5
/* 801D56D8 001D27B8  41 82 00 10 */	beq .L_801D56E8
/* 801D56DC 001D27BC  80 1F 30 00 */	lwz r0, 0x3000(r31)
/* 801D56E0 001D27C0  54 00 03 DF */	rlwinm. r0, r0, 0, 15, 15
/* 801D56E4 001D27C4  41 82 FF C8 */	beq .L_801D56AC
.L_801D56E8:
/* 801D56E8 001D27C8  3C 60 CC 00 */	lis r3, 0xcc00
/* 801D56EC 001D27CC  80 03 30 00 */	lwz r0, 0x3000(r3)
/* 801D56F0 001D27D0  54 00 03 DF */	rlwinm. r0, r0, 0, 15, 15
/* 801D56F4 001D27D4  40 82 00 34 */	bne .L_801D5728
/* 801D56F8 001D27D8  38 00 00 01 */	li r0, 0x1
/* 801D56FC 001D27DC  90 0D 9C AC */	stw r0, Down@sda21(r13)
/* 801D5700 001D27E0  38 60 02 00 */	li r3, 0x200
/* 801D5704 001D27E4  90 0D 9C B0 */	stw r0, LastState@sda21(r13)
/* 801D5708 001D27E8  4B FF EF D1 */	bl __OSMaskInterrupts
/* 801D570C 001D27EC  81 8D 9C A8 */	lwz r12, ResetCallback@sda21(r13)
/* 801D5710 001D27F0  28 0C 00 00 */	cmplwi r12, 0x0
/* 801D5714 001D27F4  41 82 00 14 */	beq .L_801D5728
/* 801D5718 001D27F8  38 00 00 00 */	li r0, 0x0
/* 801D571C 001D27FC  7D 88 03 A6 */	mtlr r12
/* 801D5720 001D2800  90 0D 9C A8 */	stw r0, ResetCallback@sda21(r13)
/* 801D5724 001D2804  4E 80 00 21 */	blrl
.L_801D5728:
/* 801D5728 001D2808  38 00 00 02 */	li r0, 0x2
/* 801D572C 001D280C  3C 60 CC 00 */	lis r3, 0xcc00
/* 801D5730 001D2810  90 03 30 00 */	stw r0, 0x3000(r3)
/* 801D5734 001D2814  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 801D5738 001D2818  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 801D573C 001D281C  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 801D5740 001D2820  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 801D5744 001D2824  38 21 00 28 */	addi r1, r1, 0x28
/* 801D5748 001D2828  7C 08 03 A6 */	mtlr r0
/* 801D574C 001D282C  4E 80 00 20 */	blr
.endfn __OSResetSWInterruptHandler

.fn OSGetResetButtonState, global
/* 801D5750 001D2830  7C 08 02 A6 */	mflr r0
/* 801D5754 001D2834  90 01 00 04 */	stw r0, 0x4(r1)
/* 801D5758 001D2838  94 21 FF E8 */	stwu r1, -0x18(r1)
/* 801D575C 001D283C  93 E1 00 14 */	stw r31, 0x14(r1)
/* 801D5760 001D2840  93 C1 00 10 */	stw r30, 0x10(r1)
/* 801D5764 001D2844  93 A1 00 0C */	stw r29, 0xc(r1)
/* 801D5768 001D2848  4B FF EB A9 */	bl OSDisableInterrupts
/* 801D576C 001D284C  7C 7E 1B 78 */	mr r30, r3
/* 801D5770 001D2850  48 00 1D FD */	bl __OSGetSystemTime
/* 801D5774 001D2854  3C A0 CC 00 */	lis r5, 0xcc00
/* 801D5778 001D2858  80 05 30 00 */	lwz r0, 0x3000(r5)
/* 801D577C 001D285C  54 00 03 DF */	rlwinm. r0, r0, 0, 15, 15
/* 801D5780 001D2860  40 82 00 DC */	bne .L_801D585C
/* 801D5784 001D2864  80 0D 9C AC */	lwz r0, Down@sda21(r13)
/* 801D5788 001D2868  2C 00 00 00 */	cmpwi r0, 0x0
/* 801D578C 001D286C  40 82 00 40 */	bne .L_801D57CC
/* 801D5790 001D2870  80 0D 9C B8 */	lwz r0, HoldUp@sda21(r13)
/* 801D5794 001D2874  38 C0 00 00 */	li r6, 0x0
/* 801D5798 001D2878  80 AD 9C BC */	lwz r5, HoldUp+0x4@sda21(r13)
/* 801D579C 001D287C  38 E0 00 01 */	li r7, 0x1
/* 801D57A0 001D2880  7C 00 32 78 */	xor r0, r0, r6
/* 801D57A4 001D2884  7C A5 32 78 */	xor r5, r5, r6
/* 801D57A8 001D2888  90 ED 9C AC */	stw r7, Down@sda21(r13)
/* 801D57AC 001D288C  7C A0 03 79 */	or. r0, r5, r0
/* 801D57B0 001D2890  41 82 00 08 */	beq .L_801D57B8
/* 801D57B4 001D2894  48 00 00 08 */	b .L_801D57BC
.L_801D57B8:
/* 801D57B8 001D2898  7C C7 33 78 */	mr r7, r6
.L_801D57BC:
/* 801D57BC 001D289C  90 8D 9C C4 */	stw r4, HoldDown+0x4@sda21(r13)
/* 801D57C0 001D28A0  7C FD 3B 78 */	mr r29, r7
/* 801D57C4 001D28A4  90 6D 9C C0 */	stw r3, HoldDown@sda21(r13)
/* 801D57C8 001D28A8  48 00 01 48 */	b .L_801D5910
.L_801D57CC:
/* 801D57CC 001D28AC  80 0D 9C B8 */	lwz r0, HoldUp@sda21(r13)
/* 801D57D0 001D28B0  39 20 00 00 */	li r9, 0x0
/* 801D57D4 001D28B4  80 AD 9C BC */	lwz r5, HoldUp+0x4@sda21(r13)
/* 801D57D8 001D28B8  39 40 00 01 */	li r10, 0x1
/* 801D57DC 001D28BC  7C 00 4A 78 */	xor r0, r0, r9
/* 801D57E0 001D28C0  7C A5 4A 78 */	xor r5, r5, r9
/* 801D57E4 001D28C4  7C A0 03 79 */	or. r0, r5, r0
/* 801D57E8 001D28C8  40 82 00 58 */	bne .L_801D5840
/* 801D57EC 001D28CC  3C C0 80 00 */	lis r6, 0x8000
/* 801D57F0 001D28D0  80 AD 9C C4 */	lwz r5, HoldDown+0x4@sda21(r13)
/* 801D57F4 001D28D4  80 E6 00 F8 */	lwz r7, 0xf8(r6)
/* 801D57F8 001D28D8  3C C0 43 1C */	lis r6, 0x431c
/* 801D57FC 001D28DC  39 06 DE 83 */	addi r8, r6, -0x217d
/* 801D5800 001D28E0  80 0D 9C C0 */	lwz r0, HoldDown@sda21(r13)
/* 801D5804 001D28E4  54 E6 F0 BE */	srwi r6, r7, 2
/* 801D5808 001D28E8  7C C8 30 16 */	mulhwu r6, r8, r6
/* 801D580C 001D28EC  54 C6 8B FE */	srwi r6, r6, 15
/* 801D5810 001D28F0  1C C6 00 64 */	mulli r6, r6, 0x64
/* 801D5814 001D28F4  7C E5 20 10 */	subfc r7, r5, r4
/* 801D5818 001D28F8  7C 00 19 10 */	subfe r0, r0, r3
/* 801D581C 001D28FC  54 C8 E8 FE */	srwi r8, r6, 3
/* 801D5820 001D2900  6C 05 80 00 */	xoris r5, r0, 0x8000
/* 801D5824 001D2904  6D 26 80 00 */	xoris r6, r9, 0x8000
/* 801D5828 001D2908  7C 07 40 10 */	subfc r0, r7, r8
/* 801D582C 001D290C  7C A5 31 10 */	subfe r5, r5, r6
/* 801D5830 001D2910  7C A6 31 10 */	subfe r5, r6, r6
/* 801D5834 001D2914  7C A5 00 D1 */	neg. r5, r5
/* 801D5838 001D2918  40 82 00 08 */	bne .L_801D5840
/* 801D583C 001D291C  7D 2A 4B 78 */	mr r10, r9
.L_801D5840:
/* 801D5840 001D2920  2C 0A 00 00 */	cmpwi r10, 0x0
/* 801D5844 001D2924  41 82 00 0C */	beq .L_801D5850
/* 801D5848 001D2928  38 00 00 01 */	li r0, 0x1
/* 801D584C 001D292C  48 00 00 08 */	b .L_801D5854
.L_801D5850:
/* 801D5850 001D2930  38 00 00 00 */	li r0, 0x0
.L_801D5854:
/* 801D5854 001D2934  7C 1D 03 78 */	mr r29, r0
/* 801D5858 001D2938  48 00 00 B8 */	b .L_801D5910
.L_801D585C:
/* 801D585C 001D293C  80 0D 9C AC */	lwz r0, Down@sda21(r13)
/* 801D5860 001D2940  2C 00 00 00 */	cmpwi r0, 0x0
/* 801D5864 001D2944  41 82 00 34 */	beq .L_801D5898
/* 801D5868 001D2948  80 AD 9C B0 */	lwz r5, LastState@sda21(r13)
/* 801D586C 001D294C  38 00 00 00 */	li r0, 0x0
/* 801D5870 001D2950  90 0D 9C AC */	stw r0, Down@sda21(r13)
/* 801D5874 001D2954  2C 05 00 00 */	cmpwi r5, 0x0
/* 801D5878 001D2958  3B A5 00 00 */	addi r29, r5, 0x0
/* 801D587C 001D295C  41 82 00 10 */	beq .L_801D588C
/* 801D5880 001D2960  90 8D 9C BC */	stw r4, HoldUp+0x4@sda21(r13)
/* 801D5884 001D2964  90 6D 9C B8 */	stw r3, HoldUp@sda21(r13)
/* 801D5888 001D2968  48 00 00 88 */	b .L_801D5910
.L_801D588C:
/* 801D588C 001D296C  90 0D 9C BC */	stw r0, HoldUp+0x4@sda21(r13)
/* 801D5890 001D2970  90 0D 9C B8 */	stw r0, HoldUp@sda21(r13)
/* 801D5894 001D2974  48 00 00 7C */	b .L_801D5910
.L_801D5898:
/* 801D5898 001D2978  80 CD 9C B8 */	lwz r6, HoldUp@sda21(r13)
/* 801D589C 001D297C  39 00 00 00 */	li r8, 0x0
/* 801D58A0 001D2980  80 ED 9C BC */	lwz r7, HoldUp+0x4@sda21(r13)
/* 801D58A4 001D2984  7C C0 42 78 */	xor r0, r6, r8
/* 801D58A8 001D2988  7C E5 42 78 */	xor r5, r7, r8
/* 801D58AC 001D298C  7C A0 03 79 */	or. r0, r5, r0
/* 801D58B0 001D2990  41 82 00 50 */	beq .L_801D5900
/* 801D58B4 001D2994  3C A0 80 00 */	lis r5, 0x8000
/* 801D58B8 001D2998  80 05 00 F8 */	lwz r0, 0xf8(r5)
/* 801D58BC 001D299C  3C A0 10 62 */	lis r5, 0x1062
/* 801D58C0 001D29A0  38 A5 4D D3 */	addi r5, r5, 0x4dd3
/* 801D58C4 001D29A4  54 00 F0 BE */	srwi r0, r0, 2
/* 801D58C8 001D29A8  7C 05 00 16 */	mulhwu r0, r5, r0
/* 801D58CC 001D29AC  54 00 D1 BE */	srwi r0, r0, 6
/* 801D58D0 001D29B0  1C 00 00 28 */	mulli r0, r0, 0x28
/* 801D58D4 001D29B4  7C E7 20 10 */	subfc r7, r7, r4
/* 801D58D8 001D29B8  7C A6 19 10 */	subfe r5, r6, r3
/* 801D58DC 001D29BC  6C A6 80 00 */	xoris r6, r5, 0x8000
/* 801D58E0 001D29C0  6D 05 80 00 */	xoris r5, r8, 0x8000
/* 801D58E4 001D29C4  7C 00 38 10 */	subfc r0, r0, r7
/* 801D58E8 001D29C8  7C A5 31 10 */	subfe r5, r5, r6
/* 801D58EC 001D29CC  7C A6 31 10 */	subfe r5, r6, r6
/* 801D58F0 001D29D0  7C A5 00 D1 */	neg. r5, r5
/* 801D58F4 001D29D4  41 82 00 0C */	beq .L_801D5900
/* 801D58F8 001D29D8  3B A0 00 01 */	li r29, 0x1
/* 801D58FC 001D29DC  48 00 00 14 */	b .L_801D5910
.L_801D5900:
/* 801D5900 001D29E0  38 00 00 00 */	li r0, 0x0
/* 801D5904 001D29E4  90 0D 9C BC */	stw r0, HoldUp+0x4@sda21(r13)
/* 801D5908 001D29E8  3B A0 00 00 */	li r29, 0x0
/* 801D590C 001D29EC  90 0D 9C B8 */	stw r0, HoldUp@sda21(r13)
.L_801D5910:
/* 801D5910 001D29F0  3C A0 80 00 */	lis r5, 0x8000
/* 801D5914 001D29F4  93 AD 9C B0 */	stw r29, LastState@sda21(r13)
/* 801D5918 001D29F8  88 05 30 E3 */	lbz r0, 0x30e3(r5)
/* 801D591C 001D29FC  54 00 06 BF */	clrlwi. r0, r0, 26
/* 801D5920 001D2A00  41 82 00 A0 */	beq .L_801D59C0
/* 801D5924 001D2A04  1D 40 00 3C */	mulli r10, r0, 0x3c
/* 801D5928 001D2A08  80 05 00 F8 */	lwz r0, 0xf8(r5)
/* 801D592C 001D2A0C  81 2D 9C 3C */	lwz r9, __OSStartTime+0x4@sda21(r13)
/* 801D5930 001D2A10  81 0D 9C 38 */	lwz r8, __OSStartTime@sda21(r13)
/* 801D5934 001D2A14  54 06 F0 BE */	srwi r6, r0, 2
/* 801D5938 001D2A18  7D 40 FE 70 */	srawi r0, r10, 31
/* 801D593C 001D2A1C  7C E0 31 D6 */	mullw r7, r0, r6
/* 801D5940 001D2A20  7C 0A 30 16 */	mulhwu r0, r10, r6
/* 801D5944 001D2A24  7C AA 31 D6 */	mullw r5, r10, r6
/* 801D5948 001D2A28  7D 29 28 14 */	addc r9, r9, r5
/* 801D594C 001D2A2C  3B E0 00 00 */	li r31, 0x0
/* 801D5950 001D2A30  7C E7 02 14 */	add r7, r7, r0
/* 801D5954 001D2A34  7C 0A F9 D6 */	mullw r0, r10, r31
/* 801D5958 001D2A38  7C 07 02 14 */	add r0, r7, r0
/* 801D595C 001D2A3C  7D 08 01 14 */	adde r8, r8, r0
/* 801D5960 001D2A40  6D 07 80 00 */	xoris r7, r8, 0x8000
/* 801D5964 001D2A44  6C 65 80 00 */	xoris r5, r3, 0x8000
/* 801D5968 001D2A48  7C 04 48 10 */	subfc r0, r4, r9
/* 801D596C 001D2A4C  7C A5 39 10 */	subfe r5, r5, r7
/* 801D5970 001D2A50  7C A7 39 10 */	subfe r5, r7, r7
/* 801D5974 001D2A54  7C A5 00 D1 */	neg. r5, r5
/* 801D5978 001D2A58  41 82 00 48 */	beq .L_801D59C0
/* 801D597C 001D2A5C  7C 89 20 10 */	subfc r4, r9, r4
/* 801D5980 001D2A60  7C 68 19 10 */	subfe r3, r8, r3
/* 801D5984 001D2A64  38 A0 00 00 */	li r5, 0x0
/* 801D5988 001D2A68  48 01 7C CD */	bl __div2i
/* 801D598C 001D2A6C  38 A0 00 00 */	li r5, 0x0
/* 801D5990 001D2A70  38 C0 00 02 */	li r6, 0x2
/* 801D5994 001D2A74  48 01 7C C1 */	bl __div2i
/* 801D5998 001D2A78  38 00 00 01 */	li r0, 0x1
/* 801D599C 001D2A7C  7C 84 00 38 */	and r4, r4, r0
/* 801D59A0 001D2A80  7C 60 F8 38 */	and r0, r3, r31
/* 801D59A4 001D2A84  7C 83 FA 78 */	xor r3, r4, r31
/* 801D59A8 001D2A88  7C 00 FA 78 */	xor r0, r0, r31
/* 801D59AC 001D2A8C  7C 60 03 79 */	or. r0, r3, r0
/* 801D59B0 001D2A90  40 82 00 0C */	bne .L_801D59BC
/* 801D59B4 001D2A94  3B A0 00 01 */	li r29, 0x1
/* 801D59B8 001D2A98  48 00 00 08 */	b .L_801D59C0
.L_801D59BC:
/* 801D59BC 001D2A9C  3B A0 00 00 */	li r29, 0x0
.L_801D59C0:
/* 801D59C0 001D2AA0  7F C3 F3 78 */	mr r3, r30
/* 801D59C4 001D2AA4  4B FF E9 75 */	bl OSRestoreInterrupts
/* 801D59C8 001D2AA8  7F A3 EB 78 */	mr r3, r29
/* 801D59CC 001D2AAC  80 01 00 1C */	lwz r0, 0x1c(r1)
/* 801D59D0 001D2AB0  83 E1 00 14 */	lwz r31, 0x14(r1)
/* 801D59D4 001D2AB4  83 C1 00 10 */	lwz r30, 0x10(r1)
/* 801D59D8 001D2AB8  83 A1 00 0C */	lwz r29, 0xc(r1)
/* 801D59DC 001D2ABC  38 21 00 18 */	addi r1, r1, 0x18
/* 801D59E0 001D2AC0  7C 08 03 A6 */	mtlr r0
/* 801D59E4 001D2AC4  4E 80 00 20 */	blr
.endfn OSGetResetButtonState

# 0x803CC5A8 - 0x803CC5C8
.section .sbss, "wa", @nobits
.balign 8

.obj ResetCallback, local
	.skip 0x4
.endobj ResetCallback

.obj Down, local
	.skip 0x4
.endobj Down

.obj LastState, local
	.skip 0x4
.endobj LastState
	.skip 0x4

.obj HoldUp, local
	.skip 0x8
.endobj HoldUp

.obj HoldDown, local
	.skip 0x8
.endobj HoldDown
