.include "macros.inc"
.file "CARDRdwr.c"

# 0x801BD3D4 - 0x801BD66C
.text
.balign 4

.fn BlockReadCallback, local
/* 801BD3D4 001BA4B4  7C 08 02 A6 */	mflr r0
/* 801BD3D8 001BA4B8  90 01 00 04 */	stw r0, 0x4(r1)
/* 801BD3DC 001BA4BC  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 801BD3E0 001BA4C0  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 801BD3E4 001BA4C4  3B E3 00 00 */	addi r31, r3, 0x0
/* 801BD3E8 001BA4C8  3C 60 80 38 */	lis r3, __CARDBlock@ha
/* 801BD3EC 001BA4CC  93 C1 00 18 */	stw r30, 0x18(r1)
/* 801BD3F0 001BA4D0  1C BF 01 10 */	mulli r5, r31, 0x110
/* 801BD3F4 001BA4D4  93 A1 00 14 */	stw r29, 0x14(r1)
/* 801BD3F8 001BA4D8  38 03 D4 80 */	addi r0, r3, __CARDBlock@l
/* 801BD3FC 001BA4DC  7C 9D 23 79 */	mr. r29, r4
/* 801BD400 001BA4E0  7F C0 2A 14 */	add r30, r0, r5
/* 801BD404 001BA4E4  41 80 00 50 */	blt .L_801BD454
/* 801BD408 001BA4E8  80 7E 00 B8 */	lwz r3, 0xb8(r30)
/* 801BD40C 001BA4EC  38 03 02 00 */	addi r0, r3, 0x200
/* 801BD410 001BA4F0  90 1E 00 B8 */	stw r0, 0xb8(r30)
/* 801BD414 001BA4F4  80 7E 00 B0 */	lwz r3, 0xb0(r30)
/* 801BD418 001BA4F8  38 03 02 00 */	addi r0, r3, 0x200
/* 801BD41C 001BA4FC  90 1E 00 B0 */	stw r0, 0xb0(r30)
/* 801BD420 001BA500  80 7E 00 B4 */	lwz r3, 0xb4(r30)
/* 801BD424 001BA504  38 03 02 00 */	addi r0, r3, 0x200
/* 801BD428 001BA508  90 1E 00 B4 */	stw r0, 0xb4(r30)
/* 801BD42C 001BA50C  80 7E 00 AC */	lwz r3, 0xac(r30)
/* 801BD430 001BA510  34 03 FF FF */	addic. r0, r3, -0x1
/* 801BD434 001BA514  90 1E 00 AC */	stw r0, 0xac(r30)
/* 801BD438 001BA518  40 81 00 1C */	ble .L_801BD454
/* 801BD43C 001BA51C  3C 60 80 1C */	lis r3, BlockReadCallback@ha
/* 801BD440 001BA520  38 83 D3 D4 */	addi r4, r3, BlockReadCallback@l
/* 801BD444 001BA524  38 7F 00 00 */	addi r3, r31, 0x0
/* 801BD448 001BA528  4B FF E4 81 */	bl __CARDReadSegment
/* 801BD44C 001BA52C  7C 7D 1B 79 */	mr. r29, r3
/* 801BD450 001BA530  40 80 00 44 */	bge .L_801BD494
.L_801BD454:
/* 801BD454 001BA534  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 801BD458 001BA538  28 00 00 00 */	cmplwi r0, 0x0
/* 801BD45C 001BA53C  40 82 00 10 */	bne .L_801BD46C
/* 801BD460 001BA540  38 7E 00 00 */	addi r3, r30, 0x0
/* 801BD464 001BA544  38 9D 00 00 */	addi r4, r29, 0x0
/* 801BD468 001BA548  4B FF E9 35 */	bl __CARDPutControlBlock
.L_801BD46C:
/* 801BD46C 001BA54C  80 1E 00 D4 */	lwz r0, 0xd4(r30)
/* 801BD470 001BA550  28 00 00 00 */	cmplwi r0, 0x0
/* 801BD474 001BA554  7C 0C 03 78 */	mr r12, r0
/* 801BD478 001BA558  41 82 00 1C */	beq .L_801BD494
/* 801BD47C 001BA55C  38 00 00 00 */	li r0, 0x0
/* 801BD480 001BA560  7D 88 03 A6 */	mtlr r12
/* 801BD484 001BA564  90 1E 00 D4 */	stw r0, 0xd4(r30)
/* 801BD488 001BA568  38 7F 00 00 */	addi r3, r31, 0x0
/* 801BD48C 001BA56C  38 9D 00 00 */	addi r4, r29, 0x0
/* 801BD490 001BA570  4E 80 00 21 */	blrl
.L_801BD494:
/* 801BD494 001BA574  80 01 00 24 */	lwz r0, 0x24(r1)
/* 801BD498 001BA578  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 801BD49C 001BA57C  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 801BD4A0 001BA580  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 801BD4A4 001BA584  38 21 00 20 */	addi r1, r1, 0x20
/* 801BD4A8 001BA588  7C 08 03 A6 */	mtlr r0
/* 801BD4AC 001BA58C  4E 80 00 20 */	blr
.endfn BlockReadCallback

.fn __CARDRead, global
/* 801BD4B0 001BA590  7C 08 02 A6 */	mflr r0
/* 801BD4B4 001BA594  1D 23 01 10 */	mulli r9, r3, 0x110
/* 801BD4B8 001BA598  90 01 00 04 */	stw r0, 0x4(r1)
/* 801BD4BC 001BA59C  3D 00 80 38 */	lis r8, __CARDBlock@ha
/* 801BD4C0 001BA5A0  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 801BD4C4 001BA5A4  38 08 D4 80 */	addi r0, r8, __CARDBlock@l
/* 801BD4C8 001BA5A8  7D 00 4A 14 */	add r8, r0, r9
/* 801BD4CC 001BA5AC  80 08 00 00 */	lwz r0, 0x0(r8)
/* 801BD4D0 001BA5B0  2C 00 00 00 */	cmpwi r0, 0x0
/* 801BD4D4 001BA5B4  40 82 00 0C */	bne .L_801BD4E0
/* 801BD4D8 001BA5B8  38 60 FF FD */	li r3, -0x3
/* 801BD4DC 001BA5BC  48 00 00 28 */	b .L_801BD504
.L_801BD4E0:
/* 801BD4E0 001BA5C0  90 E8 00 D4 */	stw r7, 0xd4(r8)
/* 801BD4E4 001BA5C4  54 A0 BA 7E */	srwi r0, r5, 9
/* 801BD4E8 001BA5C8  3C A0 80 1C */	lis r5, BlockReadCallback@ha
/* 801BD4EC 001BA5CC  90 08 00 AC */	stw r0, 0xac(r8)
/* 801BD4F0 001BA5D0  38 05 D3 D4 */	addi r0, r5, BlockReadCallback@l
/* 801BD4F4 001BA5D4  90 88 00 B0 */	stw r4, 0xb0(r8)
/* 801BD4F8 001BA5D8  7C 04 03 78 */	mr r4, r0
/* 801BD4FC 001BA5DC  90 C8 00 B4 */	stw r6, 0xb4(r8)
/* 801BD500 001BA5E0  4B FF E3 C9 */	bl __CARDReadSegment
.L_801BD504:
/* 801BD504 001BA5E4  80 01 00 0C */	lwz r0, 0xc(r1)
/* 801BD508 001BA5E8  38 21 00 08 */	addi r1, r1, 0x8
/* 801BD50C 001BA5EC  7C 08 03 A6 */	mtlr r0
/* 801BD510 001BA5F0  4E 80 00 20 */	blr
.endfn __CARDRead

.fn BlockWriteCallback, local
/* 801BD514 001BA5F4  7C 08 02 A6 */	mflr r0
/* 801BD518 001BA5F8  90 01 00 04 */	stw r0, 0x4(r1)
/* 801BD51C 001BA5FC  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 801BD520 001BA600  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 801BD524 001BA604  3B E3 00 00 */	addi r31, r3, 0x0
/* 801BD528 001BA608  3C 60 80 38 */	lis r3, __CARDBlock@ha
/* 801BD52C 001BA60C  93 C1 00 18 */	stw r30, 0x18(r1)
/* 801BD530 001BA610  1C BF 01 10 */	mulli r5, r31, 0x110
/* 801BD534 001BA614  93 A1 00 14 */	stw r29, 0x14(r1)
/* 801BD538 001BA618  38 03 D4 80 */	addi r0, r3, __CARDBlock@l
/* 801BD53C 001BA61C  7C 9D 23 79 */	mr. r29, r4
/* 801BD540 001BA620  7F C0 2A 14 */	add r30, r0, r5
/* 801BD544 001BA624  41 80 00 50 */	blt .L_801BD594
/* 801BD548 001BA628  80 7E 00 B8 */	lwz r3, 0xb8(r30)
/* 801BD54C 001BA62C  38 03 00 80 */	addi r0, r3, 0x80
/* 801BD550 001BA630  90 1E 00 B8 */	stw r0, 0xb8(r30)
/* 801BD554 001BA634  80 7E 00 B0 */	lwz r3, 0xb0(r30)
/* 801BD558 001BA638  38 03 00 80 */	addi r0, r3, 0x80
/* 801BD55C 001BA63C  90 1E 00 B0 */	stw r0, 0xb0(r30)
/* 801BD560 001BA640  80 7E 00 B4 */	lwz r3, 0xb4(r30)
/* 801BD564 001BA644  38 03 00 80 */	addi r0, r3, 0x80
/* 801BD568 001BA648  90 1E 00 B4 */	stw r0, 0xb4(r30)
/* 801BD56C 001BA64C  80 7E 00 AC */	lwz r3, 0xac(r30)
/* 801BD570 001BA650  34 03 FF FF */	addic. r0, r3, -0x1
/* 801BD574 001BA654  90 1E 00 AC */	stw r0, 0xac(r30)
/* 801BD578 001BA658  40 81 00 1C */	ble .L_801BD594
/* 801BD57C 001BA65C  3C 60 80 1C */	lis r3, BlockWriteCallback@ha
/* 801BD580 001BA660  38 83 D5 14 */	addi r4, r3, BlockWriteCallback@l
/* 801BD584 001BA664  38 7F 00 00 */	addi r3, r31, 0x0
/* 801BD588 001BA668  4B FF E4 75 */	bl __CARDWritePage
/* 801BD58C 001BA66C  7C 7D 1B 79 */	mr. r29, r3
/* 801BD590 001BA670  40 80 00 44 */	bge .L_801BD5D4
.L_801BD594:
/* 801BD594 001BA674  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 801BD598 001BA678  28 00 00 00 */	cmplwi r0, 0x0
/* 801BD59C 001BA67C  40 82 00 10 */	bne .L_801BD5AC
/* 801BD5A0 001BA680  38 7E 00 00 */	addi r3, r30, 0x0
/* 801BD5A4 001BA684  38 9D 00 00 */	addi r4, r29, 0x0
/* 801BD5A8 001BA688  4B FF E7 F5 */	bl __CARDPutControlBlock
.L_801BD5AC:
/* 801BD5AC 001BA68C  80 1E 00 D4 */	lwz r0, 0xd4(r30)
/* 801BD5B0 001BA690  28 00 00 00 */	cmplwi r0, 0x0
/* 801BD5B4 001BA694  7C 0C 03 78 */	mr r12, r0
/* 801BD5B8 001BA698  41 82 00 1C */	beq .L_801BD5D4
/* 801BD5BC 001BA69C  38 00 00 00 */	li r0, 0x0
/* 801BD5C0 001BA6A0  7D 88 03 A6 */	mtlr r12
/* 801BD5C4 001BA6A4  90 1E 00 D4 */	stw r0, 0xd4(r30)
/* 801BD5C8 001BA6A8  38 7F 00 00 */	addi r3, r31, 0x0
/* 801BD5CC 001BA6AC  38 9D 00 00 */	addi r4, r29, 0x0
/* 801BD5D0 001BA6B0  4E 80 00 21 */	blrl
.L_801BD5D4:
/* 801BD5D4 001BA6B4  80 01 00 24 */	lwz r0, 0x24(r1)
/* 801BD5D8 001BA6B8  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 801BD5DC 001BA6BC  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 801BD5E0 001BA6C0  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 801BD5E4 001BA6C4  38 21 00 20 */	addi r1, r1, 0x20
/* 801BD5E8 001BA6C8  7C 08 03 A6 */	mtlr r0
/* 801BD5EC 001BA6CC  4E 80 00 20 */	blr
.endfn BlockWriteCallback

.fn __CARDWrite, global
/* 801BD5F0 001BA6D0  7C 08 02 A6 */	mflr r0
/* 801BD5F4 001BA6D4  1D 23 01 10 */	mulli r9, r3, 0x110
/* 801BD5F8 001BA6D8  90 01 00 04 */	stw r0, 0x4(r1)
/* 801BD5FC 001BA6DC  3D 00 80 38 */	lis r8, __CARDBlock@ha
/* 801BD600 001BA6E0  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 801BD604 001BA6E4  38 08 D4 80 */	addi r0, r8, __CARDBlock@l
/* 801BD608 001BA6E8  7D 00 4A 14 */	add r8, r0, r9
/* 801BD60C 001BA6EC  80 08 00 00 */	lwz r0, 0x0(r8)
/* 801BD610 001BA6F0  2C 00 00 00 */	cmpwi r0, 0x0
/* 801BD614 001BA6F4  40 82 00 0C */	bne .L_801BD620
/* 801BD618 001BA6F8  38 60 FF FD */	li r3, -0x3
/* 801BD61C 001BA6FC  48 00 00 28 */	b .L_801BD644
.L_801BD620:
/* 801BD620 001BA700  90 E8 00 D4 */	stw r7, 0xd4(r8)
/* 801BD624 001BA704  54 A0 C9 FE */	srwi r0, r5, 7
/* 801BD628 001BA708  3C A0 80 1C */	lis r5, BlockWriteCallback@ha
/* 801BD62C 001BA70C  90 08 00 AC */	stw r0, 0xac(r8)
/* 801BD630 001BA710  38 05 D5 14 */	addi r0, r5, BlockWriteCallback@l
/* 801BD634 001BA714  90 88 00 B0 */	stw r4, 0xb0(r8)
/* 801BD638 001BA718  7C 04 03 78 */	mr r4, r0
/* 801BD63C 001BA71C  90 C8 00 B4 */	stw r6, 0xb4(r8)
/* 801BD640 001BA720  4B FF E3 BD */	bl __CARDWritePage
.L_801BD644:
/* 801BD644 001BA724  80 01 00 0C */	lwz r0, 0xc(r1)
/* 801BD648 001BA728  38 21 00 08 */	addi r1, r1, 0x8
/* 801BD64C 001BA72C  7C 08 03 A6 */	mtlr r0
/* 801BD650 001BA730  4E 80 00 20 */	blr
.endfn __CARDWrite

.fn CARDGetXferredBytes, global
/* 801BD654 001BA734  1C 03 01 10 */	mulli r0, r3, 0x110
/* 801BD658 001BA738  3C 60 80 38 */	lis r3, __CARDBlock@ha
/* 801BD65C 001BA73C  38 63 D4 80 */	addi r3, r3, __CARDBlock@l
/* 801BD660 001BA740  7C 63 02 14 */	add r3, r3, r0
/* 801BD664 001BA744  80 63 00 B8 */	lwz r3, 0xb8(r3)
/* 801BD668 001BA748  4E 80 00 20 */	blr
.endfn CARDGetXferredBytes
