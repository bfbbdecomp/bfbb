.include "macros.inc"
.file "CARDCreate.c"

# 0x801C0680 - 0x801C0A18
.text
.balign 4

.fn CreateCallbackFat, local
/* 801C0680 001BD760  7C 08 02 A6 */	mflr r0
/* 801C0684 001BD764  90 01 00 04 */	stw r0, 0x4(r1)
/* 801C0688 001BD768  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 801C068C 001BD76C  BF 61 00 14 */	stmw r27, 0x14(r1)
/* 801C0690 001BD770  3B 83 00 00 */	addi r28, r3, 0x0
/* 801C0694 001BD774  3C 60 80 38 */	lis r3, __CARDBlock@ha
/* 801C0698 001BD778  1C BC 01 10 */	mulli r5, r28, 0x110
/* 801C069C 001BD77C  38 03 D4 80 */	addi r0, r3, __CARDBlock@l
/* 801C06A0 001BD780  7F E0 2A 14 */	add r31, r0, r5
/* 801C06A4 001BD784  83 BF 00 D0 */	lwz r29, 0xd0(r31)
/* 801C06A8 001BD788  3B 60 00 00 */	li r27, 0x0
/* 801C06AC 001BD78C  7C 9E 23 79 */	mr. r30, r4
/* 801C06B0 001BD790  93 7F 00 D0 */	stw r27, 0xd0(r31)
/* 801C06B4 001BD794  41 80 00 C0 */	blt .L_801C0774
/* 801C06B8 001BD798  7F E3 FB 78 */	mr r3, r31
/* 801C06BC 001BD79C  4B FF D3 B5 */	bl __CARDGetDirBlock
/* 801C06C0 001BD7A0  A0 1F 00 BC */	lhz r0, 0xbc(r31)
/* 801C06C4 001BD7A4  38 A0 00 04 */	li r5, 0x4
/* 801C06C8 001BD7A8  80 9F 01 0C */	lwz r4, 0x10c(r31)
/* 801C06CC 001BD7AC  54 00 30 32 */	slwi r0, r0, 6
/* 801C06D0 001BD7B0  7F C3 02 14 */	add r30, r3, r0
/* 801C06D4 001BD7B4  38 7E 00 00 */	addi r3, r30, 0x0
/* 801C06D8 001BD7B8  4B E4 2E 69 */	bl memcpy
/* 801C06DC 001BD7BC  80 9F 01 0C */	lwz r4, 0x10c(r31)
/* 801C06E0 001BD7C0  38 7E 00 04 */	addi r3, r30, 0x4
/* 801C06E4 001BD7C4  38 A0 00 02 */	li r5, 0x2
/* 801C06E8 001BD7C8  38 84 00 04 */	addi r4, r4, 0x4
/* 801C06EC 001BD7CC  4B E4 2E 55 */	bl memcpy
/* 801C06F0 001BD7D0  38 00 00 04 */	li r0, 0x4
/* 801C06F4 001BD7D4  98 1E 00 34 */	stb r0, 0x34(r30)
/* 801C06F8 001BD7D8  38 00 FF FF */	li r0, -0x1
/* 801C06FC 001BD7DC  3C 60 80 00 */	lis r3, 0x8000
/* 801C0700 001BD7E0  9B 7E 00 35 */	stb r27, 0x35(r30)
/* 801C0704 001BD7E4  A0 9F 00 BE */	lhz r4, 0xbe(r31)
/* 801C0708 001BD7E8  B0 9E 00 36 */	sth r4, 0x36(r30)
/* 801C070C 001BD7EC  9B 7E 00 07 */	stb r27, 0x7(r30)
/* 801C0710 001BD7F0  90 1E 00 2C */	stw r0, 0x2c(r30)
/* 801C0714 001BD7F4  B3 7E 00 30 */	sth r27, 0x30(r30)
/* 801C0718 001BD7F8  B3 7E 00 32 */	sth r27, 0x32(r30)
/* 801C071C 001BD7FC  90 1E 00 3C */	stw r0, 0x3c(r30)
/* 801C0720 001BD800  A0 1E 00 32 */	lhz r0, 0x32(r30)
/* 801C0724 001BD804  54 00 00 3A */	clrrwi r0, r0, 2
/* 801C0728 001BD808  60 00 00 01 */	ori r0, r0, 0x1
/* 801C072C 001BD80C  B0 1E 00 32 */	sth r0, 0x32(r30)
/* 801C0730 001BD810  80 9F 00 C0 */	lwz r4, 0xc0(r31)
/* 801C0734 001BD814  93 64 00 08 */	stw r27, 0x8(r4)
/* 801C0738 001BD818  A0 1E 00 36 */	lhz r0, 0x36(r30)
/* 801C073C 001BD81C  80 9F 00 C0 */	lwz r4, 0xc0(r31)
/* 801C0740 001BD820  B0 04 00 10 */	sth r0, 0x10(r4)
/* 801C0744 001BD824  80 03 00 F8 */	lwz r0, 0xf8(r3)
/* 801C0748 001BD828  54 1B F0 BE */	srwi r27, r0, 2
/* 801C074C 001BD82C  48 01 6E 01 */	bl OSGetTime
/* 801C0750 001BD830  38 DB 00 00 */	addi r6, r27, 0x0
/* 801C0754 001BD834  38 A0 00 00 */	li r5, 0x0
/* 801C0758 001BD838  48 02 CE FD */	bl __div2i
/* 801C075C 001BD83C  90 9E 00 28 */	stw r4, 0x28(r30)
/* 801C0760 001BD840  38 7C 00 00 */	addi r3, r28, 0x0
/* 801C0764 001BD844  38 9D 00 00 */	addi r4, r29, 0x0
/* 801C0768 001BD848  4B FF D4 A9 */	bl __CARDUpdateDir
/* 801C076C 001BD84C  7C 7E 1B 79 */	mr. r30, r3
/* 801C0770 001BD850  40 80 00 2C */	bge .L_801C079C
.L_801C0774:
/* 801C0774 001BD854  38 7F 00 00 */	addi r3, r31, 0x0
/* 801C0778 001BD858  38 9E 00 00 */	addi r4, r30, 0x0
/* 801C077C 001BD85C  4B FF B6 21 */	bl __CARDPutControlBlock
/* 801C0780 001BD860  28 1D 00 00 */	cmplwi r29, 0x0
/* 801C0784 001BD864  41 82 00 18 */	beq .L_801C079C
/* 801C0788 001BD868  39 9D 00 00 */	addi r12, r29, 0x0
/* 801C078C 001BD86C  7D 88 03 A6 */	mtlr r12
/* 801C0790 001BD870  38 7C 00 00 */	addi r3, r28, 0x0
/* 801C0794 001BD874  38 9E 00 00 */	addi r4, r30, 0x0
/* 801C0798 001BD878  4E 80 00 21 */	blrl
.L_801C079C:
/* 801C079C 001BD87C  BB 61 00 14 */	lmw r27, 0x14(r1)
/* 801C07A0 001BD880  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 801C07A4 001BD884  38 21 00 28 */	addi r1, r1, 0x28
/* 801C07A8 001BD888  7C 08 03 A6 */	mtlr r0
/* 801C07AC 001BD88C  4E 80 00 20 */	blr
.endfn CreateCallbackFat

.fn CARDCreateAsync, global
/* 801C07B0 001BD890  7C 08 02 A6 */	mflr r0
/* 801C07B4 001BD894  90 01 00 04 */	stw r0, 0x4(r1)
/* 801C07B8 001BD898  94 21 FF B8 */	stwu r1, -0x48(r1)
/* 801C07BC 001BD89C  BE E1 00 24 */	stmw r23, 0x24(r1)
/* 801C07C0 001BD8A0  3B 44 00 00 */	addi r26, r4, 0x0
/* 801C07C4 001BD8A4  3B 23 00 00 */	addi r25, r3, 0x0
/* 801C07C8 001BD8A8  3B 65 00 00 */	addi r27, r5, 0x0
/* 801C07CC 001BD8AC  3B 86 00 00 */	addi r28, r6, 0x0
/* 801C07D0 001BD8B0  3B A7 00 00 */	addi r29, r7, 0x0
/* 801C07D4 001BD8B4  38 7A 00 00 */	addi r3, r26, 0x0
/* 801C07D8 001BD8B8  48 02 6F E1 */	bl strlen
/* 801C07DC 001BD8BC  28 03 00 20 */	cmplwi r3, 0x20
/* 801C07E0 001BD8C0  40 81 00 0C */	ble .L_801C07EC
/* 801C07E4 001BD8C4  38 60 FF F4 */	li r3, -0xc
/* 801C07E8 001BD8C8  48 00 01 D4 */	b .L_801C09BC
.L_801C07EC:
/* 801C07EC 001BD8CC  38 79 00 00 */	addi r3, r25, 0x0
/* 801C07F0 001BD8D0  38 81 00 1C */	addi r4, r1, 0x1c
/* 801C07F4 001BD8D4  4B FF B4 F1 */	bl __CARDGetControlBlock
/* 801C07F8 001BD8D8  2C 03 00 00 */	cmpwi r3, 0x0
/* 801C07FC 001BD8DC  40 80 00 08 */	bge .L_801C0804
/* 801C0800 001BD8E0  48 00 01 BC */	b .L_801C09BC
.L_801C0804:
/* 801C0804 001BD8E4  28 1B 00 00 */	cmplwi r27, 0x0
/* 801C0808 001BD8E8  41 82 00 1C */	beq .L_801C0824
/* 801C080C 001BD8EC  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 801C0810 001BD8F0  80 83 00 0C */	lwz r4, 0xc(r3)
/* 801C0814 001BD8F4  7C 1B 23 96 */	divwu r0, r27, r4
/* 801C0818 001BD8F8  7C 00 21 D6 */	mullw r0, r0, r4
/* 801C081C 001BD8FC  7C 00 D8 51 */	subf. r0, r0, r27
/* 801C0820 001BD900  41 82 00 0C */	beq .L_801C082C
.L_801C0824:
/* 801C0824 001BD904  38 60 FF 80 */	li r3, -0x80
/* 801C0828 001BD908  48 00 01 94 */	b .L_801C09BC
.L_801C082C:
/* 801C082C 001BD90C  3C 80 00 01 */	lis r4, 0x1
/* 801C0830 001BD910  3B C4 FF FF */	addi r30, r4, -0x1
/* 801C0834 001BD914  4B FF D2 3D */	bl __CARDGetDirBlock
/* 801C0838 001BD918  3B E3 00 00 */	addi r31, r3, 0x0
/* 801C083C 001BD91C  3B 1F 00 00 */	addi r24, r31, 0x0
/* 801C0840 001BD920  3A E0 00 00 */	li r23, 0x0
/* 801C0844 001BD924  48 00 00 8C */	b .L_801C08D0
.L_801C0848:
/* 801C0848 001BD928  88 18 00 00 */	lbz r0, 0x0(r24)
/* 801C084C 001BD92C  28 00 00 FF */	cmplwi r0, 0xff
/* 801C0850 001BD930  40 82 00 18 */	bne .L_801C0868
/* 801C0854 001BD934  57 C0 04 3E */	clrlwi r0, r30, 16
/* 801C0858 001BD938  28 00 FF FF */	cmplwi r0, 0xffff
/* 801C085C 001BD93C  40 82 00 6C */	bne .L_801C08C8
/* 801C0860 001BD940  7E FE BB 78 */	mr r30, r23
/* 801C0864 001BD944  48 00 00 64 */	b .L_801C08C8
.L_801C0868:
/* 801C0868 001BD948  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 801C086C 001BD94C  38 78 00 00 */	addi r3, r24, 0x0
/* 801C0870 001BD950  38 A0 00 04 */	li r5, 0x4
/* 801C0874 001BD954  80 84 01 0C */	lwz r4, 0x10c(r4)
/* 801C0878 001BD958  48 02 32 55 */	bl memcmp
/* 801C087C 001BD95C  2C 03 00 00 */	cmpwi r3, 0x0
/* 801C0880 001BD960  40 82 00 48 */	bne .L_801C08C8
/* 801C0884 001BD964  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 801C0888 001BD968  38 78 00 04 */	addi r3, r24, 0x4
/* 801C088C 001BD96C  38 A0 00 02 */	li r5, 0x2
/* 801C0890 001BD970  80 84 01 0C */	lwz r4, 0x10c(r4)
/* 801C0894 001BD974  38 84 00 04 */	addi r4, r4, 0x4
/* 801C0898 001BD978  48 02 32 35 */	bl memcmp
/* 801C089C 001BD97C  2C 03 00 00 */	cmpwi r3, 0x0
/* 801C08A0 001BD980  40 82 00 28 */	bne .L_801C08C8
/* 801C08A4 001BD984  38 78 00 00 */	addi r3, r24, 0x0
/* 801C08A8 001BD988  38 9A 00 00 */	addi r4, r26, 0x0
/* 801C08AC 001BD98C  4B FF F6 E5 */	bl __CARDCompareFileName
/* 801C08B0 001BD990  2C 03 00 00 */	cmpwi r3, 0x0
/* 801C08B4 001BD994  41 82 00 14 */	beq .L_801C08C8
/* 801C08B8 001BD998  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 801C08BC 001BD99C  38 80 FF F9 */	li r4, -0x7
/* 801C08C0 001BD9A0  4B FF B4 DD */	bl __CARDPutControlBlock
/* 801C08C4 001BD9A4  48 00 00 F8 */	b .L_801C09BC
.L_801C08C8:
/* 801C08C8 001BD9A8  3B 18 00 40 */	addi r24, r24, 0x40
/* 801C08CC 001BD9AC  3A F7 00 01 */	addi r23, r23, 0x1
.L_801C08D0:
/* 801C08D0 001BD9B0  56 E0 04 3E */	clrlwi r0, r23, 16
/* 801C08D4 001BD9B4  28 00 00 7F */	cmplwi r0, 0x7f
/* 801C08D8 001BD9B8  41 80 FF 70 */	blt .L_801C0848
/* 801C08DC 001BD9BC  57 C0 04 3E */	clrlwi r0, r30, 16
/* 801C08E0 001BD9C0  28 00 FF FF */	cmplwi r0, 0xffff
/* 801C08E4 001BD9C4  40 82 00 14 */	bne .L_801C08F8
/* 801C08E8 001BD9C8  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 801C08EC 001BD9CC  38 80 FF F8 */	li r4, -0x8
/* 801C08F0 001BD9D0  4B FF B4 AD */	bl __CARDPutControlBlock
/* 801C08F4 001BD9D4  48 00 00 C8 */	b .L_801C09BC
.L_801C08F8:
/* 801C08F8 001BD9D8  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 801C08FC 001BD9DC  4B FF CD 71 */	bl __CARDGetFatBlock
/* 801C0900 001BD9E0  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 801C0904 001BD9E4  A0 03 00 06 */	lhz r0, 0x6(r3)
/* 801C0908 001BD9E8  80 64 00 0C */	lwz r3, 0xc(r4)
/* 801C090C 001BD9EC  7C 03 01 D6 */	mullw r0, r3, r0
/* 801C0910 001BD9F0  7C 00 D8 40 */	cmplw r0, r27
/* 801C0914 001BD9F4  40 80 00 14 */	bge .L_801C0928
/* 801C0918 001BD9F8  38 64 00 00 */	addi r3, r4, 0x0
/* 801C091C 001BD9FC  38 80 FF F7 */	li r4, -0x9
/* 801C0920 001BDA00  4B FF B4 7D */	bl __CARDPutControlBlock
/* 801C0924 001BDA04  48 00 00 98 */	b .L_801C09BC
.L_801C0928:
/* 801C0928 001BDA08  28 1D 00 00 */	cmplwi r29, 0x0
/* 801C092C 001BDA0C  41 82 00 0C */	beq .L_801C0938
/* 801C0930 001BDA10  7F A0 EB 78 */	mr r0, r29
/* 801C0934 001BDA14  48 00 00 0C */	b .L_801C0940
.L_801C0938:
/* 801C0938 001BDA18  3C 60 80 1C */	lis r3, __CARDDefaultApiCallback@ha
/* 801C093C 001BDA1C  38 03 AD 84 */	addi r0, r3, __CARDDefaultApiCallback@l
.L_801C0940:
/* 801C0940 001BDA20  90 04 00 D0 */	stw r0, 0xd0(r4)
/* 801C0944 001BDA24  57 C0 32 B2 */	clrlslwi r0, r30, 16, 6
/* 801C0948 001BDA28  7C FF 02 14 */	add r7, r31, r0
/* 801C094C 001BDA2C  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 801C0950 001BDA30  57 DD 04 3E */	clrlwi r29, r30, 16
/* 801C0954 001BDA34  38 9A 00 00 */	addi r4, r26, 0x0
/* 801C0958 001BDA38  B3 C3 00 BC */	sth r30, 0xbc(r3)
/* 801C095C 001BDA3C  38 67 00 08 */	addi r3, r7, 0x8
/* 801C0960 001BDA40  38 A0 00 20 */	li r5, 0x20
/* 801C0964 001BDA44  80 C1 00 1C */	lwz r6, 0x1c(r1)
/* 801C0968 001BDA48  80 06 00 0C */	lwz r0, 0xc(r6)
/* 801C096C 001BDA4C  7C 1B 03 96 */	divwu r0, r27, r0
/* 801C0970 001BDA50  B0 07 00 38 */	sth r0, 0x38(r7)
/* 801C0974 001BDA54  48 02 6D 49 */	bl strncpy
/* 801C0978 001BDA58  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 801C097C 001BDA5C  3C 60 80 1C */	lis r3, CreateCallbackFat@ha
/* 801C0980 001BDA60  38 A3 06 80 */	addi r5, r3, CreateCallbackFat@l
/* 801C0984 001BDA64  93 84 00 C0 */	stw r28, 0xc0(r4)
/* 801C0988 001BDA68  7F 23 CB 78 */	mr r3, r25
/* 801C098C 001BDA6C  93 3C 00 00 */	stw r25, 0x0(r28)
/* 801C0990 001BDA70  93 BC 00 04 */	stw r29, 0x4(r28)
/* 801C0994 001BDA74  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 801C0998 001BDA78  80 04 00 0C */	lwz r0, 0xc(r4)
/* 801C099C 001BDA7C  7C 9B 03 96 */	divwu r4, r27, r0
/* 801C09A0 001BDA80  4B FF CE 71 */	bl __CARDAllocBlock
/* 801C09A4 001BDA84  7C 64 1B 79 */	mr. r4, r3
/* 801C09A8 001BDA88  40 80 00 10 */	bge .L_801C09B8
/* 801C09AC 001BDA8C  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 801C09B0 001BDA90  4B FF B3 ED */	bl __CARDPutControlBlock
/* 801C09B4 001BDA94  48 00 00 08 */	b .L_801C09BC
.L_801C09B8:
/* 801C09B8 001BDA98  7C 83 23 78 */	mr r3, r4
.L_801C09BC:
/* 801C09BC 001BDA9C  BA E1 00 24 */	lmw r23, 0x24(r1)
/* 801C09C0 001BDAA0  80 01 00 4C */	lwz r0, 0x4c(r1)
/* 801C09C4 001BDAA4  38 21 00 48 */	addi r1, r1, 0x48
/* 801C09C8 001BDAA8  7C 08 03 A6 */	mtlr r0
/* 801C09CC 001BDAAC  4E 80 00 20 */	blr
.endfn CARDCreateAsync

.fn CARDCreate, global
/* 801C09D0 001BDAB0  7C 08 02 A6 */	mflr r0
/* 801C09D4 001BDAB4  3C E0 80 1C */	lis r7, __CARDSyncCallback@ha
/* 801C09D8 001BDAB8  90 01 00 04 */	stw r0, 0x4(r1)
/* 801C09DC 001BDABC  38 E7 AD 88 */	addi r7, r7, __CARDSyncCallback@l
/* 801C09E0 001BDAC0  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 801C09E4 001BDAC4  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 801C09E8 001BDAC8  3B E3 00 00 */	addi r31, r3, 0x0
/* 801C09EC 001BDACC  4B FF FD C5 */	bl CARDCreateAsync
/* 801C09F0 001BDAD0  2C 03 00 00 */	cmpwi r3, 0x0
/* 801C09F4 001BDAD4  40 80 00 08 */	bge .L_801C09FC
/* 801C09F8 001BDAD8  48 00 00 0C */	b .L_801C0A04
.L_801C09FC:
/* 801C09FC 001BDADC  7F E3 FB 78 */	mr r3, r31
/* 801C0A00 001BDAE0  4B FF B6 8D */	bl __CARDSync
.L_801C0A04:
/* 801C0A04 001BDAE4  80 01 00 24 */	lwz r0, 0x24(r1)
/* 801C0A08 001BDAE8  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 801C0A0C 001BDAEC  38 21 00 20 */	addi r1, r1, 0x20
/* 801C0A10 001BDAF0  7C 08 03 A6 */	mtlr r0
/* 801C0A14 001BDAF4  4E 80 00 20 */	blr
.endfn CARDCreate
