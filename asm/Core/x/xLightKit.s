.include "macros.inc"
.file "xLightKit.cpp"

# 0x80123228 - 0x80123638
.text
.balign 4

# xLightKit_Prepare(void*)
.fn xLightKit_Prepare__FPv, global
/* 80123228 00120308  94 21 FF A0 */	stwu r1, -0x60(r1)
/* 8012322C 0012030C  7C 08 02 A6 */	mflr r0
/* 80123230 00120310  90 01 00 64 */	stw r0, 0x64(r1)
/* 80123234 00120314  BF 41 00 48 */	stmw r26, 0x48(r1)
/* 80123238 00120318  7C 7D 1B 78 */	mr r29, r3
/* 8012323C 0012031C  38 1D 00 10 */	addi r0, r29, 0x10
/* 80123240 00120320  3B E1 00 18 */	addi r31, r1, 0x18
/* 80123244 00120324  3B C1 00 28 */	addi r30, r1, 0x28
/* 80123248 00120328  3B 60 00 00 */	li r27, 0x0
/* 8012324C 0012032C  7C 1C 03 78 */	mr r28, r0
/* 80123250 00120330  90 03 00 0C */	stw r0, 0xc(r3)
/* 80123254 00120334  48 00 02 48 */	b .L_8012349C
.L_80123258:
/* 80123258 00120338  80 1C 00 5C */	lwz r0, 0x5c(r28)
/* 8012325C 0012033C  28 00 00 00 */	cmplwi r0, 0x0
/* 80123260 00120340  41 82 00 0C */	beq .L_8012326C
/* 80123264 00120344  7F A3 EB 78 */	mr r3, r29
/* 80123268 00120348  48 00 02 44 */	b .L_801234AC
.L_8012326C:
/* 8012326C 0012034C  C0 5C 00 04 */	lfs f2, 0x4(r28)
/* 80123270 00120350  C0 22 A0 C0 */	lfs f1, "@513"@sda21(r2)
/* 80123274 00120354  FC 02 08 40 */	fcmpo cr0, f2, f1
/* 80123278 00120358  41 81 00 1C */	bgt .L_80123294
/* 8012327C 0012035C  C0 1C 00 08 */	lfs f0, 0x8(r28)
/* 80123280 00120360  FC 00 08 40 */	fcmpo cr0, f0, f1
/* 80123284 00120364  41 81 00 10 */	bgt .L_80123294
/* 80123288 00120368  C0 1C 00 0C */	lfs f0, 0xc(r28)
/* 8012328C 0012036C  FC 00 08 40 */	fcmpo cr0, f0, f1
/* 80123290 00120370  40 81 00 80 */	ble .L_80123310
.L_80123294:
/* 80123294 00120374  C0 3C 00 08 */	lfs f1, 0x8(r28)
/* 80123298 00120378  FC 02 08 40 */	fcmpo cr0, f2, f1
/* 8012329C 0012037C  40 81 00 0C */	ble .L_801232A8
/* 801232A0 00120380  FC 00 10 90 */	fmr f0, f2
/* 801232A4 00120384  48 00 00 08 */	b .L_801232AC
.L_801232A8:
/* 801232A8 00120388  FC 00 08 90 */	fmr f0, f1
.L_801232AC:
/* 801232AC 0012038C  C0 7C 00 0C */	lfs f3, 0xc(r28)
/* 801232B0 00120390  FC 00 18 40 */	fcmpo cr0, f0, f3
/* 801232B4 00120394  40 81 00 18 */	ble .L_801232CC
/* 801232B8 00120398  FC 02 08 40 */	fcmpo cr0, f2, f1
/* 801232BC 0012039C  40 81 00 08 */	ble .L_801232C4
/* 801232C0 001203A0  48 00 00 10 */	b .L_801232D0
.L_801232C4:
/* 801232C4 001203A4  FC 40 08 90 */	fmr f2, f1
/* 801232C8 001203A8  48 00 00 08 */	b .L_801232D0
.L_801232CC:
/* 801232CC 001203AC  FC 40 18 90 */	fmr f2, f3
.L_801232D0:
/* 801232D0 001203B0  C0 02 A0 C4 */	lfs f0, "@575"@sda21(r2)
/* 801232D4 001203B4  C0 22 A0 C0 */	lfs f1, "@513"@sda21(r2)
/* 801232D8 001203B8  FC 02 00 40 */	fcmpo cr0, f2, f0
/* 801232DC 001203BC  40 81 00 08 */	ble .L_801232E4
/* 801232E0 001203C0  48 00 00 08 */	b .L_801232E8
.L_801232E4:
/* 801232E4 001203C4  FC 40 00 90 */	fmr f2, f0
.L_801232E8:
/* 801232E8 001203C8  EC 21 10 24 */	fdivs f1, f1, f2
/* 801232EC 001203CC  C0 1C 00 04 */	lfs f0, 0x4(r28)
/* 801232F0 001203D0  EC 00 00 72 */	fmuls f0, f0, f1
/* 801232F4 001203D4  D0 1C 00 04 */	stfs f0, 0x4(r28)
/* 801232F8 001203D8  C0 1C 00 08 */	lfs f0, 0x8(r28)
/* 801232FC 001203DC  EC 00 00 72 */	fmuls f0, f0, f1
/* 80123300 001203E0  D0 1C 00 08 */	stfs f0, 0x8(r28)
/* 80123304 001203E4  C0 1C 00 0C */	lfs f0, 0xc(r28)
/* 80123308 001203E8  EC 00 00 72 */	fmuls f0, f0, f1
/* 8012330C 001203EC  D0 1C 00 0C */	stfs f0, 0xc(r28)
.L_80123310:
/* 80123310 001203F0  80 1C 00 00 */	lwz r0, 0x0(r28)
/* 80123314 001203F4  2C 00 00 03 */	cmpwi r0, 0x3
/* 80123318 001203F8  41 82 00 44 */	beq .L_8012335C
/* 8012331C 001203FC  40 80 00 14 */	bge .L_80123330
/* 80123320 00120400  2C 00 00 01 */	cmpwi r0, 0x1
/* 80123324 00120404  41 82 00 18 */	beq .L_8012333C
/* 80123328 00120408  40 80 00 24 */	bge .L_8012334C
/* 8012332C 0012040C  48 00 00 4C */	b .L_80123378
.L_80123330:
/* 80123330 00120410  2C 00 00 05 */	cmpwi r0, 0x5
/* 80123334 00120414  40 80 00 44 */	bge .L_80123378
/* 80123338 00120418  48 00 00 34 */	b .L_8012336C
.L_8012333C:
/* 8012333C 0012041C  38 60 00 02 */	li r3, 0x2
/* 80123340 00120420  48 0F 43 E1 */	bl RpLightCreate
/* 80123344 00120424  90 7C 00 5C */	stw r3, 0x5c(r28)
/* 80123348 00120428  48 00 00 30 */	b .L_80123378
.L_8012334C:
/* 8012334C 0012042C  38 60 00 01 */	li r3, 0x1
/* 80123350 00120430  48 0F 43 D1 */	bl RpLightCreate
/* 80123354 00120434  90 7C 00 5C */	stw r3, 0x5c(r28)
/* 80123358 00120438  48 00 00 20 */	b .L_80123378
.L_8012335C:
/* 8012335C 0012043C  38 60 00 80 */	li r3, 0x80
/* 80123360 00120440  48 0F 43 C1 */	bl RpLightCreate
/* 80123364 00120444  90 7C 00 5C */	stw r3, 0x5c(r28)
/* 80123368 00120448  48 00 00 10 */	b .L_80123378
.L_8012336C:
/* 8012336C 0012044C  38 60 00 82 */	li r3, 0x82
/* 80123370 00120450  48 0F 43 B1 */	bl RpLightCreate
/* 80123374 00120454  90 7C 00 5C */	stw r3, 0x5c(r28)
.L_80123378:
/* 80123378 00120458  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 8012337C 0012045C  38 9C 00 04 */	addi r4, r28, 0x4
/* 80123380 00120460  48 0F 3E 31 */	bl RpLightSetColor
/* 80123384 00120464  80 1C 00 00 */	lwz r0, 0x0(r28)
/* 80123388 00120468  28 00 00 02 */	cmplwi r0, 0x2
/* 8012338C 0012046C  41 80 00 D8 */	blt .L_80123464
/* 80123390 00120470  48 11 56 F9 */	bl RwFrameCreate
/* 80123394 00120474  7C 60 1B 78 */	mr r0, r3
/* 80123398 00120478  38 61 00 08 */	addi r3, r1, 0x8
/* 8012339C 0012047C  7C 1A 03 78 */	mr r26, r0
/* 801233A0 00120480  38 80 00 00 */	li r4, 0x0
/* 801233A4 00120484  38 A0 00 40 */	li r5, 0x40
/* 801233A8 00120488  4B EE 00 B1 */	bl memset
/* 801233AC 0012048C  C0 1C 00 14 */	lfs f0, 0x14(r28)
/* 801233B0 00120490  38 61 00 08 */	addi r3, r1, 0x8
/* 801233B4 00120494  7C 64 1B 78 */	mr r4, r3
/* 801233B8 00120498  FC 00 00 50 */	fneg f0, f0
/* 801233BC 0012049C  D0 01 00 08 */	stfs f0, 0x8(r1)
/* 801233C0 001204A0  C0 1C 00 18 */	lfs f0, 0x18(r28)
/* 801233C4 001204A4  FC 00 00 50 */	fneg f0, f0
/* 801233C8 001204A8  D0 01 00 0C */	stfs f0, 0xc(r1)
/* 801233CC 001204AC  C0 1C 00 1C */	lfs f0, 0x1c(r28)
/* 801233D0 001204B0  FC 00 00 50 */	fneg f0, f0
/* 801233D4 001204B4  D0 01 00 10 */	stfs f0, 0x10(r1)
/* 801233D8 001204B8  C0 1C 00 24 */	lfs f0, 0x24(r28)
/* 801233DC 001204BC  D0 01 00 18 */	stfs f0, 0x18(r1)
/* 801233E0 001204C0  C0 1C 00 28 */	lfs f0, 0x28(r28)
/* 801233E4 001204C4  D0 01 00 1C */	stfs f0, 0x1c(r1)
/* 801233E8 001204C8  C0 1C 00 2C */	lfs f0, 0x2c(r28)
/* 801233EC 001204CC  D0 01 00 20 */	stfs f0, 0x20(r1)
/* 801233F0 001204D0  C0 1C 00 34 */	lfs f0, 0x34(r28)
/* 801233F4 001204D4  FC 00 00 50 */	fneg f0, f0
/* 801233F8 001204D8  D0 01 00 28 */	stfs f0, 0x28(r1)
/* 801233FC 001204DC  C0 1C 00 38 */	lfs f0, 0x38(r28)
/* 80123400 001204E0  FC 00 00 50 */	fneg f0, f0
/* 80123404 001204E4  D0 01 00 2C */	stfs f0, 0x2c(r1)
/* 80123408 001204E8  C0 1C 00 3C */	lfs f0, 0x3c(r28)
/* 8012340C 001204EC  FC 00 00 50 */	fneg f0, f0
/* 80123410 001204F0  D0 01 00 30 */	stfs f0, 0x30(r1)
/* 80123414 001204F4  C0 1C 00 44 */	lfs f0, 0x44(r28)
/* 80123418 001204F8  D0 01 00 38 */	stfs f0, 0x38(r1)
/* 8012341C 001204FC  C0 1C 00 48 */	lfs f0, 0x48(r28)
/* 80123420 00120500  D0 01 00 3C */	stfs f0, 0x3c(r1)
/* 80123424 00120504  C0 1C 00 4C */	lfs f0, 0x4c(r28)
/* 80123428 00120508  D0 01 00 40 */	stfs f0, 0x40(r1)
/* 8012342C 0012050C  48 11 07 85 */	bl RwV3dNormalize
/* 80123430 00120510  7F E3 FB 78 */	mr r3, r31
/* 80123434 00120514  7F E4 FB 78 */	mr r4, r31
/* 80123438 00120518  48 11 07 79 */	bl RwV3dNormalize
/* 8012343C 0012051C  7F C3 F3 78 */	mr r3, r30
/* 80123440 00120520  7F C4 F3 78 */	mr r4, r30
/* 80123444 00120524  48 11 07 6D */	bl RwV3dNormalize
/* 80123448 00120528  7F 43 D3 78 */	mr r3, r26
/* 8012344C 0012052C  38 81 00 08 */	addi r4, r1, 0x8
/* 80123450 00120530  38 A0 00 00 */	li r5, 0x0
/* 80123454 00120534  48 11 5F 29 */	bl RwFrameTransform
/* 80123458 00120538  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 8012345C 0012053C  7F 44 D3 78 */	mr r4, r26
/* 80123460 00120540  48 11 BD 95 */	bl _rwObjectHasFrameSetFrame
.L_80123464:
/* 80123464 00120544  80 1C 00 00 */	lwz r0, 0x0(r28)
/* 80123468 00120548  28 00 00 03 */	cmplwi r0, 0x3
/* 8012346C 0012054C  41 80 00 10 */	blt .L_8012347C
/* 80123470 00120550  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 80123474 00120554  C0 3C 00 54 */	lfs f1, 0x54(r28)
/* 80123478 00120558  48 0F 3C F9 */	bl RpLightSetRadius
.L_8012347C:
/* 8012347C 0012055C  80 1C 00 00 */	lwz r0, 0x0(r28)
/* 80123480 00120560  28 00 00 04 */	cmplwi r0, 0x4
/* 80123484 00120564  41 80 00 10 */	blt .L_80123494
/* 80123488 00120568  80 7C 00 5C */	lwz r3, 0x5c(r28)
/* 8012348C 0012056C  C0 3C 00 58 */	lfs f1, 0x58(r28)
/* 80123490 00120570  48 0F 3F A1 */	bl RpLightSetConeAngle
.L_80123494:
/* 80123494 00120574  3B 9C 00 60 */	addi r28, r28, 0x60
/* 80123498 00120578  3B 7B 00 01 */	addi r27, r27, 0x1
.L_8012349C:
/* 8012349C 0012057C  80 1D 00 08 */	lwz r0, 0x8(r29)
/* 801234A0 00120580  7C 1B 00 40 */	cmplw r27, r0
/* 801234A4 00120584  41 80 FD B4 */	blt .L_80123258
/* 801234A8 00120588  7F A3 EB 78 */	mr r3, r29
.L_801234AC:
/* 801234AC 0012058C  BB 41 00 48 */	lmw r26, 0x48(r1)
/* 801234B0 00120590  80 01 00 64 */	lwz r0, 0x64(r1)
/* 801234B4 00120594  7C 08 03 A6 */	mtlr r0
/* 801234B8 00120598  38 21 00 60 */	addi r1, r1, 0x60
/* 801234BC 0012059C  4E 80 00 20 */	blr
.endfn xLightKit_Prepare__FPv

# xLightKit_Enable(xLightKit*, RpWorld*)
.fn xLightKit_Enable__FP9xLightKitP7RpWorld, global
/* 801234C0 001205A0  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 801234C4 001205A4  7C 08 02 A6 */	mflr r0
/* 801234C8 001205A8  90 01 00 24 */	stw r0, 0x24(r1)
/* 801234CC 001205AC  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 801234D0 001205B0  93 C1 00 18 */	stw r30, 0x18(r1)
/* 801234D4 001205B4  93 A1 00 14 */	stw r29, 0x14(r1)
/* 801234D8 001205B8  7C 9D 23 78 */	mr r29, r4
/* 801234DC 001205BC  93 81 00 10 */	stw r28, 0x10(r1)
/* 801234E0 001205C0  7C 7C 1B 78 */	mr r28, r3
/* 801234E4 001205C4  80 0D 95 4C */	lwz r0, gLastLightKit@sda21(r13)
/* 801234E8 001205C8  7C 1C 00 40 */	cmplw r28, r0
/* 801234EC 001205CC  41 82 00 98 */	beq .L_80123584
/* 801234F0 001205D0  28 00 00 00 */	cmplwi r0, 0x0
/* 801234F4 001205D4  41 82 00 3C */	beq .L_80123530
/* 801234F8 001205D8  3B C0 00 00 */	li r30, 0x0
/* 801234FC 001205DC  3B E0 00 00 */	li r31, 0x0
/* 80123500 001205E0  48 00 00 20 */	b .L_80123520
.L_80123504:
/* 80123504 001205E4  80 83 00 0C */	lwz r4, 0xc(r3)
/* 80123508 001205E8  38 1F 00 5C */	addi r0, r31, 0x5c
/* 8012350C 001205EC  7F A3 EB 78 */	mr r3, r29
/* 80123510 001205F0  7C 84 00 2E */	lwzx r4, r4, r0
/* 80123514 001205F4  48 0F BD BD */	bl RpWorldRemoveLight
/* 80123518 001205F8  3B FF 00 60 */	addi r31, r31, 0x60
/* 8012351C 001205FC  3B DE 00 01 */	addi r30, r30, 0x1
.L_80123520:
/* 80123520 00120600  80 6D 95 4C */	lwz r3, gLastLightKit@sda21(r13)
/* 80123524 00120604  80 03 00 08 */	lwz r0, 0x8(r3)
/* 80123528 00120608  7C 1E 00 40 */	cmplw r30, r0
/* 8012352C 0012060C  41 80 FF D8 */	blt .L_80123504
.L_80123530:
/* 80123530 00120610  28 1C 00 00 */	cmplwi r28, 0x0
/* 80123534 00120614  93 8D 95 4C */	stw r28, gLastLightKit@sda21(r13)
/* 80123538 00120618  41 82 00 44 */	beq .L_8012357C
/* 8012353C 0012061C  38 00 00 01 */	li r0, 0x1
/* 80123540 00120620  3B C0 00 00 */	li r30, 0x0
/* 80123544 00120624  90 0D 95 48 */	stw r0, iModelHack_DisablePrelight@sda21(r13)
/* 80123548 00120628  7F DF F3 78 */	mr r31, r30
/* 8012354C 0012062C  48 00 00 20 */	b .L_8012356C
.L_80123550:
/* 80123550 00120630  80 9C 00 0C */	lwz r4, 0xc(r28)
/* 80123554 00120634  38 1F 00 5C */	addi r0, r31, 0x5c
/* 80123558 00120638  7F A3 EB 78 */	mr r3, r29
/* 8012355C 0012063C  7C 84 00 2E */	lwzx r4, r4, r0
/* 80123560 00120640  48 0F BC D1 */	bl RpWorldAddLight
/* 80123564 00120644  3B FF 00 60 */	addi r31, r31, 0x60
/* 80123568 00120648  3B DE 00 01 */	addi r30, r30, 0x1
.L_8012356C:
/* 8012356C 0012064C  80 1C 00 08 */	lwz r0, 0x8(r28)
/* 80123570 00120650  7C 1E 00 40 */	cmplw r30, r0
/* 80123574 00120654  41 80 FF DC */	blt .L_80123550
/* 80123578 00120658  48 00 00 0C */	b .L_80123584
.L_8012357C:
/* 8012357C 0012065C  38 00 00 00 */	li r0, 0x0
/* 80123580 00120660  90 0D 95 48 */	stw r0, iModelHack_DisablePrelight@sda21(r13)
.L_80123584:
/* 80123584 00120664  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80123588 00120668  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8012358C 0012066C  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 80123590 00120670  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 80123594 00120674  83 81 00 10 */	lwz r28, 0x10(r1)
/* 80123598 00120678  7C 08 03 A6 */	mtlr r0
/* 8012359C 0012067C  38 21 00 20 */	addi r1, r1, 0x20
/* 801235A0 00120680  4E 80 00 20 */	blr
.endfn xLightKit_Enable__FP9xLightKitP7RpWorld

# xLightKit_GetCurrent(RpWorld*)
.fn xLightKit_GetCurrent__FP7RpWorld, global
/* 801235A4 00120684  80 6D 95 4C */	lwz r3, gLastLightKit@sda21(r13)
/* 801235A8 00120688  4E 80 00 20 */	blr
.endfn xLightKit_GetCurrent__FP7RpWorld

# xLightKit_Destroy(xLightKit*)
.fn xLightKit_Destroy__FP9xLightKit, global
/* 801235AC 0012068C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 801235B0 00120690  7C 08 02 A6 */	mflr r0
/* 801235B4 00120694  90 01 00 24 */	stw r0, 0x24(r1)
/* 801235B8 00120698  BF 61 00 0C */	stmw r27, 0xc(r1)
/* 801235BC 0012069C  7C 7B 1B 79 */	mr. r27, r3
/* 801235C0 001206A0  41 82 00 64 */	beq .L_80123624
/* 801235C4 001206A4  83 BB 00 0C */	lwz r29, 0xc(r27)
/* 801235C8 001206A8  3B C0 00 00 */	li r30, 0x0
/* 801235CC 001206AC  3B E0 00 00 */	li r31, 0x0
/* 801235D0 001206B0  48 00 00 48 */	b .L_80123618
.L_801235D4:
/* 801235D4 001206B4  80 1D 00 5C */	lwz r0, 0x5c(r29)
/* 801235D8 001206B8  28 00 00 00 */	cmplwi r0, 0x0
/* 801235DC 001206BC  41 82 00 34 */	beq .L_80123610
/* 801235E0 001206C0  48 11 98 1D */	bl _rwFrameSyncDirty
/* 801235E4 001206C4  80 7D 00 5C */	lwz r3, 0x5c(r29)
/* 801235E8 001206C8  83 83 00 04 */	lwz r28, 0x4(r3)
/* 801235EC 001206CC  28 1C 00 00 */	cmplwi r28, 0x0
/* 801235F0 001206D0  41 82 00 14 */	beq .L_80123604
/* 801235F4 001206D4  38 80 00 00 */	li r4, 0x0
/* 801235F8 001206D8  48 11 BB FD */	bl _rwObjectHasFrameSetFrame
/* 801235FC 001206DC  7F 83 E3 78 */	mr r3, r28
/* 80123600 001206E0  48 11 55 C5 */	bl RwFrameDestroy
.L_80123604:
/* 80123604 001206E4  80 7D 00 5C */	lwz r3, 0x5c(r29)
/* 80123608 001206E8  48 0F 40 B9 */	bl RpLightDestroy
/* 8012360C 001206EC  93 FD 00 5C */	stw r31, 0x5c(r29)
.L_80123610:
/* 80123610 001206F0  3B BD 00 60 */	addi r29, r29, 0x60
/* 80123614 001206F4  3B DE 00 01 */	addi r30, r30, 0x1
.L_80123618:
/* 80123618 001206F8  80 1B 00 08 */	lwz r0, 0x8(r27)
/* 8012361C 001206FC  7C 1E 00 40 */	cmplw r30, r0
/* 80123620 00120700  41 80 FF B4 */	blt .L_801235D4
.L_80123624:
/* 80123624 00120704  BB 61 00 0C */	lmw r27, 0xc(r1)
/* 80123628 00120708  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8012362C 0012070C  7C 08 03 A6 */	mtlr r0
/* 80123630 00120710  38 21 00 20 */	addi r1, r1, 0x20
/* 80123634 00120714  4E 80 00 20 */	blr
.endfn xLightKit_Destroy__FP9xLightKit

# 0x803CBE48 - 0x803CBE50
.section .sbss, "wa", @nobits
.balign 8

.obj iModelHack_DisablePrelight, global
	.skip 0x4
.endobj iModelHack_DisablePrelight

.obj gLastLightKit, global
	.skip 0x4
.endobj gLastLightKit

# 0x803CEA40 - 0x803CEA48
.section .sdata2, "a"
.balign 8

.obj "@513", local
	.4byte 0x3F800000
.endobj "@513"

.obj "@575", local
	.4byte 0x3727C5AC
.endobj "@575"
