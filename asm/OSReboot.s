.include "macros.inc"
.file "OSReboot.c"

# 0x801D4EDC - 0x801D5238
.text
.balign 4

.fn Run, local
/* 801D4EDC 001D1FBC  7C 00 04 AC */	sync
/* 801D4EE0 001D1FC0  4C 00 01 2C */	isync
/* 801D4EE4 001D1FC4  7C 68 03 A6 */	mtlr r3
/* 801D4EE8 001D1FC8  4E 80 00 20 */	blr
.endfn Run

.fn Callback, local
/* 801D4EEC 001D1FCC  38 00 00 01 */	li r0, 0x1
/* 801D4EF0 001D1FD0  90 0D 9C 90 */	stw r0, Prepared@sda21(r13)
/* 801D4EF4 001D1FD4  4E 80 00 20 */	blr
.endfn Callback

.fn __OSReboot, global
/* 801D4EF8 001D1FD8  7C 08 02 A6 */	mflr r0
/* 801D4EFC 001D1FDC  90 01 00 04 */	stw r0, 0x4(r1)
/* 801D4F00 001D1FE0  94 21 FC 80 */	stwu r1, -0x380(r1)
/* 801D4F04 001D1FE4  BF 41 03 68 */	stmw r26, 0x368(r1)
/* 801D4F08 001D1FE8  3C 60 80 38 */	lis r3, ...bss.0@ha
/* 801D4F0C 001D1FEC  3B C3 E0 60 */	addi r30, r3, ...bss.0@l
/* 801D4F10 001D1FF0  4B FF F4 01 */	bl OSDisableInterrupts
/* 801D4F14 001D1FF4  80 AD 9C 88 */	lwz r5, SaveStart@sda21(r13)
/* 801D4F18 001D1FF8  3C 80 81 30 */	lis r4, 0x8130
/* 801D4F1C 001D1FFC  80 0D 9C 8C */	lwz r0, SaveEnd@sda21(r13)
/* 801D4F20 001D2000  3B 60 00 00 */	li r27, 0x0
/* 801D4F24 001D2004  3F E0 81 80 */	lis r31, 0x8180
/* 801D4F28 001D2008  38 C0 00 01 */	li r6, 0x1
/* 801D4F2C 001D200C  93 7F FF FC */	stw r27, -0x4(r31)
/* 801D4F30 001D2010  3F 40 80 00 */	lis r26, 0x8000
/* 801D4F34 001D2014  93 7F FF F8 */	stw r27, -0x8(r31)
/* 801D4F38 001D2018  38 61 00 A0 */	addi r3, r1, 0xa0
/* 801D4F3C 001D201C  98 DA 30 E2 */	stb r6, 0x30e2(r26)
/* 801D4F40 001D2020  90 A4 DF F0 */	stw r5, -0x2010(r4)
/* 801D4F44 001D2024  90 04 DF EC */	stw r0, -0x2014(r4)
/* 801D4F48 001D2028  4B FF DC 25 */	bl OSClearContext
/* 801D4F4C 001D202C  38 61 00 A0 */	addi r3, r1, 0xa0
/* 801D4F50 001D2030  4B FF DA 55 */	bl OSSetCurrentContext
/* 801D4F54 001D2034  4B FE F1 D9 */	bl DVDInit
/* 801D4F58 001D2038  38 60 00 01 */	li r3, 0x1
/* 801D4F5C 001D203C  4B FF 13 CD */	bl DVDSetAutoInvalidation
/* 801D4F60 001D2040  4B FF 13 D9 */	bl DVDResume
/* 801D4F64 001D2044  3C 60 80 1D */	lis r3, Callback@ha
/* 801D4F68 001D2048  93 6D 9C 90 */	stw r27, Prepared@sda21(r13)
/* 801D4F6C 001D204C  38 63 4E EC */	addi r3, r3, Callback@l
/* 801D4F70 001D2050  4B FF 1A B5 */	bl __DVDPrepareResetAsync
/* 801D4F74 001D2054  38 60 FF E0 */	li r3, -0x20
/* 801D4F78 001D2058  4B FF F7 61 */	bl __OSMaskInterrupts
/* 801D4F7C 001D205C  38 60 04 00 */	li r3, 0x400
/* 801D4F80 001D2060  4B FF F7 E1 */	bl __OSUnmaskInterrupts
/* 801D4F84 001D2064  4B FF F3 A1 */	bl OSEnableInterrupts
/* 801D4F88 001D2068  48 00 25 C5 */	bl OSGetTime
/* 801D4F8C 001D206C  7C 9D 23 78 */	mr r29, r4
/* 801D4F90 001D2070  7C 7C 1B 78 */	mr r28, r3
/* 801D4F94 001D2074  48 00 00 04 */	b .L_801D4F98
.L_801D4F98:
/* 801D4F98 001D2078  80 1A 00 F8 */	lwz r0, 0xf8(r26)
/* 801D4F9C 001D207C  6F 7A 80 00 */	xoris r26, r27, 0x8000
/* 801D4FA0 001D2080  54 1B F0 BE */	srwi r27, r0, 2
/* 801D4FA4 001D2084  48 00 00 04 */	b .L_801D4FA8
.L_801D4FA8:
/* 801D4FA8 001D2088  48 00 00 40 */	b .L_801D4FE8
.L_801D4FAC:
/* 801D4FAC 001D208C  4B FF 19 81 */	bl DVDCheckDisk
/* 801D4FB0 001D2090  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D4FB4 001D2094  41 82 00 2C */	beq .L_801D4FE0
/* 801D4FB8 001D2098  48 00 25 95 */	bl OSGetTime
/* 801D4FBC 001D209C  7C 9D 20 10 */	subfc r4, r29, r4
/* 801D4FC0 001D20A0  7C 1C 19 10 */	subfe r0, r28, r3
/* 801D4FC4 001D20A4  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 801D4FC8 001D20A8  7C 04 D8 10 */	subfc r0, r4, r27
/* 801D4FCC 001D20AC  7C 63 D1 10 */	subfe r3, r3, r26
/* 801D4FD0 001D20B0  7C 7A D1 10 */	subfe r3, r26, r26
/* 801D4FD4 001D20B4  7C 63 00 D0 */	neg r3, r3
/* 801D4FD8 001D20B8  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D4FDC 001D20BC  41 82 00 0C */	beq .L_801D4FE8
.L_801D4FE0:
/* 801D4FE0 001D20C0  80 7F FF FC */	lwz r3, -0x4(r31)
/* 801D4FE4 001D20C4  48 00 03 49 */	bl __OSDoHotReset
.L_801D4FE8:
/* 801D4FE8 001D20C8  80 0D 9C 90 */	lwz r0, Prepared@sda21(r13)
/* 801D4FEC 001D20CC  2C 00 00 01 */	cmpwi r0, 0x1
/* 801D4FF0 001D20D0  40 82 FF BC */	bne .L_801D4FAC
/* 801D4FF4 001D20D4  80 0D 9C 0C */	lwz r0, __OSIsGcam@sda21(r13)
/* 801D4FF8 001D20D8  2C 00 00 00 */	cmpwi r0, 0x0
/* 801D4FFC 001D20DC  40 82 00 C8 */	bne .L_801D50C4
/* 801D5000 001D20E0  4B FF 19 25 */	bl DVDGetCurrentDiskID
/* 801D5004 001D20E4  88 03 00 08 */	lbz r0, 0x8(r3)
/* 801D5008 001D20E8  28 00 00 00 */	cmplwi r0, 0x0
/* 801D500C 001D20EC  41 82 00 0C */	beq .L_801D5018
/* 801D5010 001D20F0  38 00 00 01 */	li r0, 0x1
/* 801D5014 001D20F4  48 00 00 08 */	b .L_801D501C
.L_801D5018:
/* 801D5018 001D20F8  38 00 00 00 */	li r0, 0x0
.L_801D501C:
/* 801D501C 001D20FC  2C 00 00 00 */	cmpwi r0, 0x0
/* 801D5020 001D2100  41 82 00 A4 */	beq .L_801D50C4
/* 801D5024 001D2104  38 60 00 00 */	li r3, 0x0
/* 801D5028 001D2108  4B FE 06 E5 */	bl AISetStreamVolLeft
/* 801D502C 001D210C  38 60 00 00 */	li r3, 0x0
/* 801D5030 001D2110  4B FE 07 09 */	bl AISetStreamVolRight
/* 801D5034 001D2114  38 61 00 70 */	addi r3, r1, 0x70
/* 801D5038 001D2118  38 80 00 00 */	li r4, 0x0
/* 801D503C 001D211C  4B FF 10 25 */	bl DVDCancelStreamAsync
/* 801D5040 001D2120  48 00 25 0D */	bl OSGetTime
/* 801D5044 001D2124  7C 9F 23 78 */	mr r31, r4
/* 801D5048 001D2128  7C 7D 1B 78 */	mr r29, r3
/* 801D504C 001D212C  48 00 00 04 */	b .L_801D5050
.L_801D5050:
/* 801D5050 001D2130  3C 60 80 00 */	lis r3, 0x8000
/* 801D5054 001D2134  80 63 00 F8 */	lwz r3, 0xf8(r3)
/* 801D5058 001D2138  38 00 00 00 */	li r0, 0x0
/* 801D505C 001D213C  6C 1B 80 00 */	xoris r27, r0, 0x8000
/* 801D5060 001D2140  54 7C F0 BE */	srwi r28, r3, 2
/* 801D5064 001D2144  3F 40 81 80 */	lis r26, 0x8180
/* 801D5068 001D2148  48 00 00 04 */	b .L_801D506C
.L_801D506C:
/* 801D506C 001D214C  48 00 00 40 */	b .L_801D50AC
.L_801D5070:
/* 801D5070 001D2150  4B FF 18 BD */	bl DVDCheckDisk
/* 801D5074 001D2154  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D5078 001D2158  41 82 00 2C */	beq .L_801D50A4
/* 801D507C 001D215C  48 00 24 D1 */	bl OSGetTime
/* 801D5080 001D2160  7C 9F 20 10 */	subfc r4, r31, r4
/* 801D5084 001D2164  7C 1D 19 10 */	subfe r0, r29, r3
/* 801D5088 001D2168  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 801D508C 001D216C  7C 04 E0 10 */	subfc r0, r4, r28
/* 801D5090 001D2170  7C 63 D9 10 */	subfe r3, r3, r27
/* 801D5094 001D2174  7C 7B D9 10 */	subfe r3, r27, r27
/* 801D5098 001D2178  7C 63 00 D0 */	neg r3, r3
/* 801D509C 001D217C  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D50A0 001D2180  41 82 00 0C */	beq .L_801D50AC
.L_801D50A4:
/* 801D50A4 001D2184  80 7A FF FC */	lwz r3, -0x4(r26)
/* 801D50A8 001D2188  48 00 02 85 */	bl __OSDoHotReset
.L_801D50AC:
/* 801D50AC 001D218C  38 61 00 70 */	addi r3, r1, 0x70
/* 801D50B0 001D2190  4B FF 11 81 */	bl DVDGetCommandBlockStatus
/* 801D50B4 001D2194  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D50B8 001D2198  40 82 FF B8 */	bne .L_801D5070
/* 801D50BC 001D219C  38 60 00 00 */	li r3, 0x0
/* 801D50C0 001D21A0  4B FE 03 8D */	bl AISetStreamPlayState
.L_801D50C4:
/* 801D50C4 001D21A4  7F C4 F3 78 */	mr r4, r30
/* 801D50C8 001D21A8  38 61 00 40 */	addi r3, r1, 0x40
/* 801D50CC 001D21AC  38 A0 00 20 */	li r5, 0x20
/* 801D50D0 001D21B0  38 C0 24 40 */	li r6, 0x2440
/* 801D50D4 001D21B4  38 E0 00 00 */	li r7, 0x0
/* 801D50D8 001D21B8  39 00 00 00 */	li r8, 0x0
/* 801D50DC 001D21BC  4B FF 0C 39 */	bl DVDReadAbsAsyncPrio
/* 801D50E0 001D21C0  48 00 24 6D */	bl OSGetTime
/* 801D50E4 001D21C4  7C 9A 23 78 */	mr r26, r4
/* 801D50E8 001D21C8  7C 7F 1B 78 */	mr r31, r3
/* 801D50EC 001D21CC  48 00 00 04 */	b .L_801D50F0
.L_801D50F0:
/* 801D50F0 001D21D0  3C 60 80 00 */	lis r3, 0x8000
/* 801D50F4 001D21D4  80 63 00 F8 */	lwz r3, 0xf8(r3)
/* 801D50F8 001D21D8  38 00 00 00 */	li r0, 0x0
/* 801D50FC 001D21DC  6C 1C 80 00 */	xoris r28, r0, 0x8000
/* 801D5100 001D21E0  54 7D F0 BE */	srwi r29, r3, 2
/* 801D5104 001D21E4  3F 60 81 80 */	lis r27, 0x8180
/* 801D5108 001D21E8  48 00 00 04 */	b .L_801D510C
.L_801D510C:
/* 801D510C 001D21EC  48 00 00 40 */	b .L_801D514C
.L_801D5110:
/* 801D5110 001D21F0  4B FF 18 1D */	bl DVDCheckDisk
/* 801D5114 001D21F4  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D5118 001D21F8  41 82 00 2C */	beq .L_801D5144
/* 801D511C 001D21FC  48 00 24 31 */	bl OSGetTime
/* 801D5120 001D2200  7C 9A 20 10 */	subfc r4, r26, r4
/* 801D5124 001D2204  7C 1F 19 10 */	subfe r0, r31, r3
/* 801D5128 001D2208  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 801D512C 001D220C  7C 04 E8 10 */	subfc r0, r4, r29
/* 801D5130 001D2210  7C 63 E1 10 */	subfe r3, r3, r28
/* 801D5134 001D2214  7C 7C E1 10 */	subfe r3, r28, r28
/* 801D5138 001D2218  7C 63 00 D0 */	neg r3, r3
/* 801D513C 001D221C  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D5140 001D2220  41 82 00 0C */	beq .L_801D514C
.L_801D5144:
/* 801D5144 001D2224  80 7B FF FC */	lwz r3, -0x4(r27)
/* 801D5148 001D2228  48 00 01 E5 */	bl __OSDoHotReset
.L_801D514C:
/* 801D514C 001D222C  38 61 00 40 */	addi r3, r1, 0x40
/* 801D5150 001D2230  4B FF 10 E1 */	bl DVDGetCommandBlockStatus
/* 801D5154 001D2234  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D5158 001D2238  40 82 FF B8 */	bne .L_801D5110
/* 801D515C 001D223C  80 BE 00 18 */	lwz r5, 0x18(r30)
/* 801D5160 001D2240  38 61 00 10 */	addi r3, r1, 0x10
/* 801D5164 001D2244  80 DE 00 14 */	lwz r6, 0x14(r30)
/* 801D5168 001D2248  3C 80 81 30 */	lis r4, 0x8130
/* 801D516C 001D224C  38 05 00 1F */	addi r0, r5, 0x1f
/* 801D5170 001D2250  38 C6 00 20 */	addi r6, r6, 0x20
/* 801D5174 001D2254  54 1A 00 34 */	clrrwi r26, r0, 5
/* 801D5178 001D2258  7F 45 D3 78 */	mr r5, r26
/* 801D517C 001D225C  38 C6 24 40 */	addi r6, r6, 0x2440
/* 801D5180 001D2260  38 E0 00 00 */	li r7, 0x0
/* 801D5184 001D2264  39 00 00 00 */	li r8, 0x0
/* 801D5188 001D2268  4B FF 0B 8D */	bl DVDReadAbsAsyncPrio
/* 801D518C 001D226C  48 00 23 C1 */	bl OSGetTime
/* 801D5190 001D2270  7C 9B 23 78 */	mr r27, r4
/* 801D5194 001D2274  7C 7C 1B 78 */	mr r28, r3
/* 801D5198 001D2278  48 00 00 04 */	b .L_801D519C
.L_801D519C:
/* 801D519C 001D227C  3C 60 80 00 */	lis r3, 0x8000
/* 801D51A0 001D2280  80 63 00 F8 */	lwz r3, 0xf8(r3)
/* 801D51A4 001D2284  38 00 00 00 */	li r0, 0x0
/* 801D51A8 001D2288  6C 1F 80 00 */	xoris r31, r0, 0x8000
/* 801D51AC 001D228C  54 7D F0 BE */	srwi r29, r3, 2
/* 801D51B0 001D2290  3F C0 81 80 */	lis r30, 0x8180
/* 801D51B4 001D2294  48 00 00 04 */	b .L_801D51B8
.L_801D51B8:
/* 801D51B8 001D2298  48 00 00 40 */	b .L_801D51F8
.L_801D51BC:
/* 801D51BC 001D229C  4B FF 17 71 */	bl DVDCheckDisk
/* 801D51C0 001D22A0  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D51C4 001D22A4  41 82 00 2C */	beq .L_801D51F0
/* 801D51C8 001D22A8  48 00 23 85 */	bl OSGetTime
/* 801D51CC 001D22AC  7C 9B 20 10 */	subfc r4, r27, r4
/* 801D51D0 001D22B0  7C 1C 19 10 */	subfe r0, r28, r3
/* 801D51D4 001D22B4  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 801D51D8 001D22B8  7C 04 E8 10 */	subfc r0, r4, r29
/* 801D51DC 001D22BC  7C 63 F9 10 */	subfe r3, r3, r31
/* 801D51E0 001D22C0  7C 7F F9 10 */	subfe r3, r31, r31
/* 801D51E4 001D22C4  7C 63 00 D0 */	neg r3, r3
/* 801D51E8 001D22C8  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D51EC 001D22CC  41 82 00 0C */	beq .L_801D51F8
.L_801D51F0:
/* 801D51F0 001D22D0  80 7E FF FC */	lwz r3, -0x4(r30)
/* 801D51F4 001D22D4  48 00 01 39 */	bl __OSDoHotReset
.L_801D51F8:
/* 801D51F8 001D22D8  38 61 00 10 */	addi r3, r1, 0x10
/* 801D51FC 001D22DC  4B FF 10 35 */	bl DVDGetCommandBlockStatus
/* 801D5200 001D22E0  2C 03 00 00 */	cmpwi r3, 0x0
/* 801D5204 001D22E4  40 82 FF B8 */	bne .L_801D51BC
/* 801D5208 001D22E8  3C 60 81 30 */	lis r3, 0x8130
/* 801D520C 001D22EC  7F 44 D3 78 */	mr r4, r26
/* 801D5210 001D22F0  4B FF D1 D5 */	bl ICInvalidateRange
/* 801D5214 001D22F4  4B FF F0 FD */	bl OSDisableInterrupts
/* 801D5218 001D22F8  4B FF D2 01 */	bl ICFlashInvalidate
/* 801D521C 001D22FC  3C 60 81 30 */	lis r3, 0x8130
/* 801D5220 001D2300  4B FF FC BD */	bl Run
/* 801D5224 001D2304  BB 41 03 68 */	lmw r26, 0x368(r1)
/* 801D5228 001D2308  80 01 03 84 */	lwz r0, 0x384(r1)
/* 801D522C 001D230C  38 21 03 80 */	addi r1, r1, 0x380
/* 801D5230 001D2310  7C 08 03 A6 */	mtlr r0
/* 801D5234 001D2314  4E 80 00 20 */	blr
.endfn __OSReboot

# 0x8037E060 - 0x8037E080
.section .bss, "wa", @nobits
.balign 8

.obj Header, local
.sym ...bss.0, local
	.skip 0x20
.endobj Header

# 0x803CC588 - 0x803CC598
.section .sbss, "wa", @nobits
.balign 8

.obj SaveStart, local
	.skip 0x4
.endobj SaveStart

.obj SaveEnd, local
	.skip 0x4
.endobj SaveEnd

.obj Prepared, local
	.skip 0x4
.endobj Prepared
	.skip 0x4
